<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>üìà Candlestick Library ‚Äì ‡∏î‡∏π‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô + ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0f172a; --paper:#fff; --ink:#0f172a;
  --muted:#475569; --line:#e2e8f0; --brand:#0f766e;
  --radius:16px; --shadow:0 16px 40px -22px rgba(15,23,42,.25);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Sarabun",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,#0f172a 0%, #0f172a 180px, #f1f5f9 180px, #f1f5f9 100%);
  color:var(--ink);
}

/* Header */
header{
  position:sticky; top:0; z-index:50;
  background:rgba(15,23,42,.9);
  backdrop-filter:blur(8px);
  color:#fff; padding:14px 16px;
  box-shadow:0 10px 30px -20px rgba(0,0,0,.4)
}
header .wrap{
  max-width:980px; margin:auto; display:flex; gap:12px; align-items:center; flex-wrap:wrap;
}
.title{font-weight:700; font-size:1.25rem}
.search{
  margin-left:auto; display:flex; align-items:center; gap:8px;
  background:rgba(255,255,255,.12); padding:6px 10px; border-radius:999px; width:min(460px,100%)
}
.search input{border:none; outline:none; background:transparent; color:#fff; width:100%}
.search ::placeholder{color:rgba(255,255,255,.75)}

/* Card List */
.layout{max-width:980px; margin:14px auto 30px; padding:0 16px}
#candles{
  background:var(--paper); border-radius:var(--radius); box-shadow:var(--shadow);
  border:1px solid rgba(15,118,110,.08); padding:14px;
}
.card{
  display:grid; grid-template-columns:82px 1fr; gap:12px;
  border:1px solid var(--line); border-radius:14px;
  margin:10px 0; background:#fff; cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease;
}
.card:hover{transform:translateY(-2px); box-shadow:0 16px 30px -20px rgba(15,23,42,.2)}
.thumb{width:100%; height:70px; border-radius:10px; object-fit:cover; background:#e2e8f0;}
.c-name{font-weight:700; color:#0f172a}
.c-meta{color:#475569; font-size:.75rem}
.tag{display:inline-block; background:#ecfdf3; border:1px solid #bbf7d0; color:#166534; font-size:.7rem; padding:3px 8px; border-radius:999px; margin-top:4px}
.tag.red{background:#fef2f2; border-color:#fecaca; color:#b91c1c}
.tag.blue{background:#eff6ff; border-color:#dbeafe; color:#1d4ed8}

/* Pager */
.pager{display:flex; justify-content:center; gap:8px; margin-top:8px}
.pager .btn{border:1px solid var(--line); background:#fff; border-radius:10px; padding:5px 10px; cursor:pointer}
.pager .btn[disabled]{opacity:.5; cursor:not-allowed}
.pager .info{font-size:.85rem; color:#475569; padding:3px 0}

/* Modal */
dialog{
  width:min(920px, 95vw); border:none; border-radius:20px; overflow:hidden;
  background:#fff; box-shadow:0 30px 70px -20px rgba(15,23,42,.45);
}
.modal-head{
  display:flex; gap:12px; align-items:center;
  background:#0f172a; color:#fff; padding:14px 16px;
}
.modal-body{
  display:grid; grid-template-columns:280px 1fr; gap:18px; padding:16px; background:#fff;
}
.modal-left img{
  width:100%; height:200px; object-fit:cover;
  background:#e2e8f0; border-radius:16px; border:1px solid #e2e8f0;
}
.img-caption{font-size:.7rem; color:#64748b; margin-top:6px;}
.modal-right h4{margin:.4rem 0 .3rem; font-size:.78rem; color:#0f172a;}
.text-block{line-height:1.6; font-size:.85rem; color:#0f172a; white-space:pre-wrap;}
.meta-line{font-size:.75rem; color:#475569; margin-bottom:.4rem;}
.tip{background:#f8fafc; border:1px solid #e2e8f0; border-radius:12px; padding:8px 10px; font-size:.75rem; line-height:1.5; white-space:pre-wrap;}
.btn-link{display:inline-block; background:#0f766e; color:#fff; padding:7px 12px; border-radius:10px; font-size:.75rem; text-decoration:none;}
.modal-footer{padding:10px 16px 14px; background:#fff; border-top:1px solid #e2e8f0; text-align:right; font-size:.7rem; color:#94a3b8;}
.close-btn{margin-left:auto; background:#fff; color:#0f172a; border:none; border-radius:999px; padding:6px 14px; cursor:pointer; font-weight:600;}
@media (max-width:650px){.modal-body{grid-template-columns:1fr}.modal-left img{height:220px}}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="title">üìà Candlestick Library ‚Äì ‡∏î‡∏π‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô + ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</div>
    <div class="search">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
      <input id="q" type="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: bullish / bearish / engulfing / ‡∏î‡∏≤‡∏ß‡∏ï‡∏Å / 3 ‡∏ï‡∏±‡∏ß / 2 ‡πÅ‡∏ó‡πà‡∏á ...">
    </div>
  </div>
</header>

<div class="layout">
  <section id="candles" aria-label="candlestick patterns"></section>
  <div id="pager" class="pager"></div>
</div>

<!-- Modal -->
<dialog id="detailModal">
  <div class="modal-head">
    <h3 id="mTitle">Pattern</h3>
    <button class="close-btn" onclick="modal.close()">‡∏õ‡∏¥‡∏î</button>
  </div>
  <div class="modal-body">
    <div class="modal-left">
      <img id="mImg" alt="">
      <div id="mImgCaption" class="img-caption"></div>
    </div>
    <div class="modal-right">
      <div id="mMeta" class="meta-line"></div>
      <h4>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h4>
      <div id="mSummary" class="text-block"></div>
      <h4>‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ</h4>
      <pre id="mTip" class="tip"></pre>
      <h4>‡πÅ‡∏´‡∏•‡πà‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á / ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü</h4>
      <a id="mSource" class="btn-link" target="_blank" rel="noopener">‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå</a>
    </div>
  </div>
  <div class="modal-footer"><small>‡∏Å‡∏î‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö</small></div>
</dialog>

<script>
const SHEET_CSV_URL = "candlestick_100_full.csv";
let RAW = [], CURRENT = [];
let page = 1;
const pageSize = 20;
const PLACEHOLDER = "https://placehold.co/640x360/e2e8f0/94a3b8?text=Candle";

async function loadCSV(){
  return new Promise((resolve,reject)=>{
    Papa.parse(SHEET_CSV_URL,{
      download:true, header:true, skipEmptyLines:true,
      complete:res=>resolve(res.data), error:reject
    });
  });
}

function applyFilters(){
  const q = document.getElementById('q').value.trim().toLowerCase();
  CURRENT = RAW.filter(r=>{
    const hay = `${r.name||""} ${r.side||""} ${r.grouping||""} ${r.summary||""} ${r.tip||""}`.toLowerCase();
    return q==="" ? true : hay.includes(q);
  });
  page=1; renderList();
}

function renderList(){
  const host=document.getElementById('candles'); host.innerHTML="";
  if(CURRENT.length===0){host.innerHTML=`<div style='padding:10px;color:#475569'>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô</div>`;return;}
  const totalPages=Math.ceil(CURRENT.length/pageSize);
  const start=(page-1)*pageSize, end=start+pageSize;
  const slice=CURRENT.slice(start,end);
  slice.forEach(r=>{
    const card=document.createElement('article'); card.className='card';
    const img=document.createElement('img');
    img.className='thumb'; img.src=r.image||PLACEHOLDER;
    img.onerror=()=>img.src=PLACEHOLDER;
    const right=document.createElement('div');
    const tagColor=r.side==="Bearish"?" red":(r.side==="Bullish"?"":"");
    right.innerHTML=`
      <div class="c-name">${r.name||""}</div>
      <div class="c-meta">${r.grouping||""} ‚Ä¢ ${r.side||""} ‚Ä¢ ${r.count?r.count+" ‡πÅ‡∏ó‡πà‡∏á":""}</div>
      <span class="tag${tagColor}">${r.side||"Pattern"}</span>
      ${r.grouping?`<span class="tag blue">${r.grouping}</span>`:""}
    `;
    card.append(img,right);
    card.addEventListener('click',()=>openModal(r));
    host.append(card);
  });
}

const modal=document.getElementById('detailModal');
function openModal(r){
  document.getElementById('mTitle').textContent=r.name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠";
  const imgEl=document.getElementById('mImg');
  imgEl.src=(r.image||"").trim()||PLACEHOLDER;
  imgEl.onerror=()=>{imgEl.src=PLACEHOLDER};
  document.getElementById('mImgCaption').textContent=r.side?`‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ù‡∏±‡πà‡∏á ${r.side}`:"";
  const metaParts=[];
  if(r.side)metaParts.push(r.side);
  if(r.grouping)metaParts.push(r.grouping);
  if(r.count)metaParts.push(r.count+" ‡πÅ‡∏ó‡πà‡∏á");
  document.getElementById('mMeta').textContent=metaParts.join(" ‚Ä¢ ");
  document.getElementById('mSummary').textContent=r.summary||"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢";
  document.getElementById('mTip').textContent=r.tip||"‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö‡πÅ‡∏ô‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏≠‡∏•‡∏∏‡πà‡∏°";
  const linkEl=document.getElementById('mSource');
  if(r.source_url){linkEl.href=r.source_url;linkEl.style.display="inline-block";}
  else linkEl.style.display="none";
  modal.showModal();
}

document.getElementById('q').addEventListener('input',applyFilters);
(async function init(){RAW=await loadCSV();applyFilters();})();
</script>
</body>
</html>
