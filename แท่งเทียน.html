<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>üìà Candlestick Library ‚Äì ‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô + ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0f172a; --paper:#fff; --ink:#0f172a;
  --muted:#475569; --line:#e2e8f0; --brand:#0f766e;
  --radius:16px; --shadow:0 16px 40px -22px rgba(15,23,42,.25);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Sarabun",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,#0f172a 0%, #0f172a 180px, #f1f5f9 180px, #f1f5f9 100%);
  color:var(--ink);
}
header{
  position:sticky; top:0; z-index:50;
  background:rgba(15,23,42,.9);
  backdrop-filter:blur(8px);
  color:#fff; padding:14px 16px;
  box-shadow:0 10px 30px -20px rgba(0,0,0,.4)
}
header .wrap{
  max-width:980px; margin:auto; display:flex; gap:12px; align-items:center; flex-wrap:wrap;
}
.title{font-weight:700; font-size:1.25rem}
.search{
  margin-left:auto; display:flex; align-items:center; gap:8px;
  background:rgba(255,255,255,.12); padding:6px 10px; border-radius:999px; width:min(460px,100%)
}
.search input{border:none; outline:none; background:transparent; color:#fff; width:100%}
.search ::placeholder{color:rgba(255,255,255,.75)}
.layout{max-width:980px; margin:14px auto 30px; padding:0 16px}

/* category buttons */
#filters{
  display:flex; gap:8px; margin-bottom:10px; flex-wrap:wrap;
}
.filter-btn{
  border:1px solid rgba(15,118,110,.2);
  background:#fff;
  color:#0f172a;
  border-radius:999px;
  padding:5px 12px;
  cursor:pointer;
  font-size:.78rem;
}
.filter-btn.active{
  background:#0f766e;
  color:#fff;
  border-color:transparent;
}

#candles{
  background:var(--paper); border-radius:var(--radius); box-shadow:var(--shadow);
  border:1px solid rgba(15,118,110,.08); padding:14px;
}
.card{
  display:grid; grid-template-columns:76px 1fr; gap:12px;
  border:1px solid var(--line); border-radius:14px;
  margin:10px 0; background:#fff; cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease;
}
.card:hover{transform:translateY(-2px); box-shadow:0 16px 30px -20px rgba(15,23,42,.2)}

.thumb{
  width:100%; height:70px; border-radius:12px;
  background:#e2e8f0;
  display:flex; align-items:center; justify-content:center;
  overflow:hidden;
}
.thumb img{width:100%; height:100%; object-fit:contain}

.c-name{font-weight:700; color:#0f172a}
.c-meta{color:#475569; font-size:.75rem}
.tag{display:inline-block; background:#ecfdf3; border:1px solid #bbf7d0; color:#166534; font-size:.7rem; padding:3px 8px; border-radius:999px; margin-top:4px}
.tag.red{background:#fef2f2; border-color:#fecaca; color:#b91c1c}
.tag.blue{background:#eff6ff; border-color:#dbeafe; color:#1d4ed8}

.pager{display:flex; justify-content:center; gap:8px; margin-top:8px; align-items:center}
.pager .btn{border:1px solid var(--line); background:#fff; border-radius:10px; padding:5px 10px; cursor:pointer}
.pager .btn[disabled]{opacity:.5; cursor:not-allowed}
.pager .info{font-size:.85rem; color:#475569; padding:3px 0}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="title">üìà Candlestick Library ‚Äì ‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô + ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</div>
    <div class="search">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>
      <input id="q" type="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: bullish / bearish / hammer / ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ ..." />
    </div>
  </div>
</header>

<div class="layout">
  <div id="filters">
    <button class="filter-btn active" data-filter="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    <button class="filter-btn" data-filter="bullish">‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô</button>
    <button class="filter-btn" data-filter="bearish">‡∏Ç‡∏≤‡∏•‡∏á</button>
    <button class="filter-btn" data-filter="tech">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</button>
  </div>

  <section id="candles" aria-label="candlestick patterns"></section>
  <div id="pager" class="pager"></div>
</div>

<script>
const SHEET_CSV_URL = "candlestick_100_full.csv"; // ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏û‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏°‡∏≤
let RAW = [], CURRENT = [];
let page = 1;
const pageSize = 10;
let currentFilter = "all";

async function loadCSV(){
  return new Promise((resolve,reject)=>{
    Papa.parse(SHEET_CSV_URL,{
      download:true, header:true, skipEmptyLines:true,
      complete:res=>resolve(res.data),
      error:reject
    });
  });
}

function applyFilters(){
  const q = document.getElementById('q').value.trim().toLowerCase();
  CURRENT = RAW.filter(r=>{
    // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î
    if (currentFilter === "bullish" && r.side !== "Bullish") return false;
    if (currentFilter === "bearish" && r.side !== "Bearish") return false;
    if (currentFilter === "tech" && r.grouping !== "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ") return false;

    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
    const hay = `${r.name||""} ${r.side||""} ${r.grouping||""} ${r.summary||""} ${r.tip||""}`.toLowerCase();
    return q === "" ? true : hay.includes(q);
  });
  page = 1;
  renderList();
}

function renderList(){
  const host = document.getElementById('candles');
  host.innerHTML = "";
  if (CURRENT.length === 0){
    host.innerHTML = `<div style="padding:10px;color:#475569">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>`;
    document.getElementById('pager').innerHTML = "";
    return;
  }

  const totalPages = Math.ceil(CURRENT.length / pageSize);
  const start = (page-1)*pageSize;
  const end = start + pageSize;
  const slice = CURRENT.slice(start, end);

  slice.forEach(r=>{
    const card = document.createElement('article');
    card.className = 'card';

    // thumb
    const thumb = document.createElement('div');
    thumb.className = 'thumb';
    if (r.image){
      const img = document.createElement('img');
      img.src = r.image;
      img.alt = r.name || "pattern";
      img.onerror = () => {
        // ‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡∏õ‡∏´‡∏≤‡∏¢ ‡∏ß‡∏≤‡∏î‡πÅ‡∏ó‡πà‡∏á‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡πÅ‡∏ó‡∏ô
        thumb.innerHTML = "";
        const bar = document.createElement('div');
        bar.style.width = "14px";
        bar.style.height = "42px";
        bar.style.borderRadius = "4px";
        bar.style.background = r.side === "Bearish" ? "#ef4444" : (r.side === "Bullish" ? "#10b981" : "#94a3b8");
        thumb.appendChild(bar);
      };
      thumb.appendChild(img);
    } else {
      const bar = document.createElement('div');
      bar.style.width = "14px";
      bar.style.height = "42px";
      bar.style.borderRadius = "4px";
      bar.style.background = r.side === "Bearish" ? "#ef4444" : (r.side === "Bullish" ? "#10b981" : "#94a3b8");
      thumb.appendChild(bar);
    }

    const right = document.createElement('div');
    const tagColor = r.side === "Bearish" ? " red" : "";
    right.innerHTML = `
      <div class="c-name">${r.name||""}</div>
      <div class="c-meta">${r.grouping||""} ${r.side? "‚Ä¢ "+r.side:""} ${r.count? "‚Ä¢ "+r.count+" ‡πÅ‡∏ó‡πà‡∏á":""}</div>
      <span class="tag${tagColor}">${r.side||"Pattern"}</span>
      ${r.grouping ? `<span class="tag blue">${r.grouping}</span>` : ""}
    `;

    card.append(thumb, right);
    host.append(card);
  });

  renderPager(totalPages);
}

function renderPager(totalPages){
  const pager = document.getElementById('pager');
  pager.innerHTML = "";

  const prev = document.createElement('button');
  prev.className = 'btn';
  prev.textContent = '‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö';
  prev.disabled = page === 1;
  prev.onclick = ()=>{ page--; renderList(); };

  const next = document.createElement('button');
  next.className = 'btn';
  next.textContent = '‡∏ñ‡∏±‡∏î‡πÑ‡∏õ';
  next.disabled = page === totalPages;
  next.onclick = ()=>{ page++; renderList(); };

  const info = document.createElement('div');
  info.className = 'info';
  info.textContent = `‡∏´‡∏ô‡πâ‡∏≤ ${page} / ${totalPages} (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${CURRENT.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`;

  pager.append(prev, info, next);
}

document.getElementById('q').addEventListener('input', applyFilters);

document.querySelectorAll('#filters .filter-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('#filters .filter-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentFilter = btn.dataset.filter;
    applyFilters();
  });
});

(async function init(){
  RAW = await loadCSV();
  applyFilters();
})();
</script>

</body>
</html>

