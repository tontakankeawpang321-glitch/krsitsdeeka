<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>Parenting Pro Mobile</title>

<!-- Preconnect for speed -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Fonts: Swap for performance -->
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&family=Kodchasan:wght@500;600;700&display=swap" rel="stylesheet">
<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  :root {
    --primary: #FF9F43;
    --primary-soft: #fff0dc;
    --accent: #54a0ff;
    --accent-soft: #eaf4ff;
    --success: #1dd1a1;
    --bg: #f7f9fc;
    --glass: rgba(255, 255, 255, 0.9);
    --text-main: #2d3436;
    --text-muted: #636e72;
    --shadow-soft: 0 4px 20px rgba(0,0,0,0.05);
    --shadow-pop: 0 10px 30px rgba(255, 159, 67, 0.25);
    --radius-l: 20px;
    --radius-m: 14px;
    --header-h: 65px;
  }

  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  
  body {
    margin: 0;
    font-family: "Sarabun", sans-serif;
    background: var(--bg);
    color: var(--text-main);
    padding-bottom: 90px;
    background-image: linear-gradient(to bottom, #fffdf7 0%, #f7f9fc 100%);
    overflow-x: hidden;
  }

  /* --- Animations (Optimized) --- */
  @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes popIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

  /* --- Structure --- */
  .container { max-width: 100%; margin: 0 auto; padding: 0 16px; }
  
  /* --- Header --- */
  header {
    position: sticky; top: 0; z-index: 100;
    background: var(--glass);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-bottom: 1px solid rgba(0,0,0,0.05);
    height: var(--header-h);
    display: flex; align-items: center;
    transition: transform 0.3s;
  }
  .nav-flex { 
    display: flex; justify-content: space-between; align-items: center; width: 100%; 
  }
  .logo { 
    font-family: "Kodchasan", sans-serif; 
    font-size: 20px; font-weight: 700; 
    color: var(--primary);
    display: flex; align-items: center; gap: 8px;
    white-space: nowrap;
  }
  
  /* Mobile Optimized Search */
  .search-wrap { position: relative; width: 100%; max-width: 220px; }
  .search-wrap input {
    width: 100%; padding: 8px 12px 8px 35px;
    border: none; background: #f1f2f6; border-radius: 50px;
    font-family: inherit; font-size: 16px;
    transition: all 0.2s;
  }
  .search-wrap input:focus { background: #fff; box-shadow: 0 0 0 2px var(--primary-soft); outline: none; }
  .search-wrap i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #b2bec3; font-size: 14px; }

  /* --- Dashboard --- */
  .dashboard {
    display: flex; flex-direction: column; gap: 20px;
    margin-top: 20px;
  }
  @media (min-width: 900px) {
    .container { max-width: 1200px; padding: 0 24px; }
    .dashboard { display: grid; grid-template-columns: 320px 1fr; gap: 30px; }
    .search-wrap { max-width: 300px; }
    .logo { font-size: 24px; }
  }

  /* --- Profile Card --- */
  .profile-card {
    background: #fff; border-radius: var(--radius-l);
    padding: 16px; box-shadow: var(--shadow-soft);
    position: relative; overflow: hidden;
    display: flex; align-items: center; gap: 15px;
  }
  .profile-bg {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(135deg, #FF9F43 0%, #ff6b6b 100%);
    opacity: 0.1; z-index: 0; pointer-events: none;
  }
  .avatar {
    width: 60px; height: 60px; background: #fff; border-radius: 50%;
    flex-shrink: 0; position: relative; z-index: 1;
    border: 2px solid #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    overflow: hidden;
  }
  .avatar img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
  .profile-info { flex: 1; position: relative; z-index: 1; }
  .user-name { font-weight: 700; font-size: 18px; margin: 0 0 4px; color: #d35400; }
  .baby-info { font-size: 13px; color: var(--text-muted); margin: 0; }
  .btn-edit-profile {
    background: transparent; border: 1px solid var(--primary); color: var(--primary);
    padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
    cursor: pointer; position: relative; z-index: 1;
  }
  @media (min-width: 900px) {
    .profile-card { flex-direction: column; text-align: center; padding: 24px; }
    .avatar { width: 80px; height: 80px; margin-bottom: 10px; }
    .btn-edit-profile { width: 100%; margin-top: 10px; background: var(--primary); color: #fff; border:none; padding:10px; }
  }

  /* --- Calendar --- */
  .calendar-widget {
    background: #fff; border-radius: var(--radius-l);
    padding: 16px; box-shadow: var(--shadow-soft);
  }
  .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; font-weight: 700; font-size: 15px; }
  .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; text-align: center; font-size: 12px; }
  .cal-day-name { color: var(--text-muted); font-weight: 600; margin-bottom: 4px; font-size: 11px; }
  .cal-date { 
    aspect-ratio: 1; display: flex; align-items: center; justify-content: center;
    border-radius: 50%; cursor: pointer; position: relative;
  }
  .cal-date.active { background: var(--primary); color: #fff; }
  .cal-date.has-event::after {
    content: ''; position: absolute; bottom: 2px; width: 4px; height: 4px;
    background: var(--success); border-radius: 50%;
  }

  /* --- Roadmap --- */
  .section-title { 
    font-family: "Kodchasan"; font-size: 18px; margin-bottom: 12px; 
    display: flex; align-items: center; gap: 8px; color: var(--text-main);
  }
  .section-title i { color: var(--primary); }
  .roadmap-scroll {
    display: flex; gap: 12px; overflow-x: auto; padding-bottom: 15px; margin-bottom: 20px;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch; scrollbar-width: none;
  }
  .roadmap-scroll::-webkit-scrollbar { display: none; }
  .roadmap-card {
    min-width: 160px; flex: 0 0 auto; scroll-snap-align: start;
    background: #fff; border-radius: var(--radius-m); padding: 16px;
    box-shadow: var(--shadow-soft); border: 1px solid transparent;
    cursor: pointer; transition: transform 0.2s; position: relative;
  }
  .roadmap-card:active { transform: scale(0.98); }
  .roadmap-card.active { border-color: var(--primary); background: #fffcf5; }
  .roadmap-card .icon-box {
    width: 36px; height: 36px; background: var(--primary-soft); color: var(--primary);
    border-radius: 10px; display: flex; align-items: center; justify-content: center;
    font-size: 18px; margin-bottom: 10px;
  }
  .roadmap-card h4 { margin: 0 0 4px; font-size: 14px; color: #333; }
  .roadmap-card p { margin: 0; font-size: 11px; color: var(--text-muted); }

  /* --- Articles --- */
  .article-grid {
    display: grid; grid-template-columns: 1fr; gap: 16px;
  }
  @media (min-width: 600px) { .article-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (min-width: 900px) { .article-grid { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); } }
  
  .article-card {
    background: #fff; border-radius: var(--radius-m); overflow: hidden;
    box-shadow: var(--shadow-soft); display: flex; flex-direction: column;
    animation: slideUp 0.5s ease backwards;
  }
  .article-body { padding: 16px; flex: 1; display: flex; flex-direction: column; }
  .article-tags { margin-bottom: 8px; }
  .tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #f1f2f6; color: #636e72; display: inline-block; margin-right: 4px; }
  .article-title { font-size: 16px; font-weight: 700; margin: 0 0 8px; line-height: 1.4; color: var(--text-main); }
  .article-desc { font-size: 13px; color: var(--text-muted); margin-bottom: 12px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
  .btn-read {
    margin-top: auto; align-self: flex-start;
    padding: 8px 14px; background: var(--accent-soft); color: var(--accent);
    border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; border: none;
  }
  .btn-read:active { background: var(--accent); color: #fff; }

  /* --- Modal --- */
  .modal-backdrop {
    position: fixed; inset: 0; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px);
    z-index: 2000; display: none; place-items: center; align-items: flex-end;
    opacity: 0; transition: opacity 0.2s;
  }
  .modal-backdrop.show { display: flex; opacity: 1; }
  .modal-modern {
    width: 100%; max-width: 800px; max-height: 90vh;
    background: #fff; 
    border-radius: 24px 24px 0 0;
    box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.2);
    display: flex; flex-direction: column;
    animation: slideUp 0.3s cubic-bezier(0.1, 0.9, 0.2, 1);
    overflow: hidden;
  }
  @media (min-width: 600px) {
    .modal-backdrop { align-items: center; }
    .modal-modern { width: 90%; border-radius: 24px; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
  }
  .modal-header { padding: 16px 20px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; }
  .modal-title { font-family: "Kodchasan"; font-size: 18px; margin: 0; color: var(--primary); }
  .btn-close {
    background: #f8f9fa; border: none; width: 36px; height: 36px; border-radius: 50%;
    cursor: pointer; display: grid; place-items: center; color: #636e72; font-size: 16px;
  }
  .modal-content { padding: 20px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
  
  /* --- Chat Interface Styles --- */
  .chat-interface { display: flex; flex-direction: column; height: 100%; background: #f8f9fa; }
  .chat-messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
  .chat-input-area { padding: 15px; background: #fff; border-top: 1px solid #eee; display: flex; gap: 10px; align-items: center; }
  .chat-input { flex: 1; padding: 12px 16px; border: 1px solid #eee; background:#f8f9fa; border-radius: 30px; outline: none; font-family: inherit; font-size:16px; transition:0.3s; }
  .chat-input:focus { background:#fff; border-color:var(--primary); box-shadow:0 0 0 3px var(--primary-soft); }
  .btn-send { width: 48px; height: 48px; background: var(--primary); color: #fff; border-radius: 50%; border: none; cursor: pointer; display: grid; place-items: center; font-size:18px; box-shadow:0 4px 10px rgba(255, 159, 67, 0.3); transition:0.2s; }
  .btn-send:active { transform:scale(0.9); }
  
  .msg { max-width: 80%; padding: 12px 18px; border-radius: 20px; font-size: 15px; line-height: 1.5; word-wrap: break-word; position:relative; }
  .msg.user { align-self: flex-end; background: var(--primary); color: #fff; border-bottom-right-radius: 4px; box-shadow: 0 4px 15px rgba(255, 159, 67, 0.2); }
  .msg.bot { align-self: flex-start; background: #fff; color: #333; border: 1px solid #eee; border-bottom-left-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }
  .typing-indicator { font-size: 12px; color: #888; margin-left: 20px; margin-bottom: 10px; display: none; font-style:italic; }

  /* Info Modal Bubbles */
  .chat-bubble {
    background: #fff; padding: 12px 16px; border-radius: 16px; border-bottom-left-radius: 4px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.03); border: 1px solid #f1f2f6;
    margin-bottom: 12px; font-size: 14px; line-height: 1.6;
  }
  .chat-bubble.highlight { background: var(--primary-soft); border-color: transparent; border-radius: 16px; border-bottom-right-radius: 4px; align-self: flex-end; }

  /* --- Form Styles for Edit Profile --- */
  .form-group { margin-bottom: 15px; }
  .form-label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 14px; }
  .form-input {
    width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 10px;
    font-family: inherit; font-size: 16px;
  }
  .btn-save {
    width: 100%; padding: 12px; background: var(--primary); color: #fff;
    border: none; border-radius: 12px; font-weight: 700; font-size: 16px; cursor: pointer;
  }

  /* --- FAB --- */
  .fab-ai {
    position: fixed; bottom: 20px; right: 20px;
    width: 56px; height: 56px;
    background: #2d3436; color: #fff;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; text-decoration: none;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    z-index: 1000;
    border: none; cursor: pointer;
    transition: transform 0.2s;
  }
  .fab-ai:active { transform: scale(0.95); }
  .hidden { display: none !important; }
</style>
</head>
<body>

<header>
  <div class="container nav-flex">
    <div class="logo">
      <i class="fa-solid fa-baby-carriage"></i> P.Pro
    </div>
    <div class="search-wrap">
      <i class="fa-solid fa-magnifying-glass"></i>
      <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
    </div>
  </div>
</header>

<main class="container">
  
  <div class="dashboard">
    
    <!-- Left Column -->
    <aside>
      <!-- Profile Card -->
      <div class="profile-card">
        <div class="profile-bg"></div>
        <div class="avatar">
          <img id="profileImg" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Baby">
        </div>
        <div class="profile-info">
          <h3 id="profileName" class="user-name">‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ö‡∏∏‡∏ç</h3>
          <p id="profileAge" class="baby-info">6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 12 ‡∏ß‡∏±‡∏ô</p>
        </div>
        <button class="btn-edit-profile" onclick="openEditProfile()">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
      </div>

      <!-- Calendar -->
      <div class="calendar-widget" style="margin-top:16px;">
        <div class="cal-header">
          <span id="monthDisplay">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2026</span>
          <span style="font-size:12px; color:var(--primary);">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
        </div>
        <div class="cal-grid">
          <div class="cal-day-name">‡∏≠‡∏≤</div><div class="cal-day-name">‡∏à</div><div class="cal-day-name">‡∏≠</div>
          <div class="cal-day-name">‡∏û</div><div class="cal-day-name">‡∏û‡∏§</div><div class="cal-day-name">‡∏®</div>
          <div class="cal-day-name">‡∏™</div>
          <!-- JS fills dates -->
        </div>
        <div id="eventDisplay" style="margin-top:12px; font-size:12px; color:var(--text-main); padding:8px; background:#f8f9fa; border-radius:8px; border-left: 3px solid var(--primary); display:none;"></div>
      </div>
    </aside>

    <!-- Right Column -->
    <section>
      <div class="section-title">
        <i class="fa-solid fa-map-location-dot"></i> Roadmap ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏•‡∏π‡∏Å
      </div>
      
      <div class="roadmap-scroll">
        <div class="roadmap-card active" onclick="filterByAge('0-6m')">
          <div class="icon-box"><i class="fa-solid fa-bottle-droplet"></i></div>
          <h4>‡πÅ‡∏£‡∏Å‡πÄ‡∏Å‡∏¥‡∏î-6‡∏î.</h4>
          <p>‡∏ô‡∏°‡πÅ‡∏°‡πà, ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô</p>
        </div>
        <div class="roadmap-card" onclick="filterByAge('6-12m')">
          <div class="icon-box"><i class="fa-solid fa-spoon"></i></div>
          <h4>6-12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h4>
          <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏∑‡πâ‡∏≠‡πÅ‡∏£‡∏Å</p>
        </div>
        <div class="roadmap-card" onclick="filterByAge('1-2y')">
          <div class="icon-box"><i class="fa-solid fa-person-walking"></i></div>
          <h4>1-2 ‡∏Ç‡∏ß‡∏ö</h4>
          <p>‡∏´‡∏±‡∏î‡πÄ‡∏î‡∏¥‡∏ô, ‡∏û‡∏π‡∏î</p>
        </div>
        <div class="roadmap-card" onclick="filterByAge('2-3y')">
          <div class="icon-box"><i class="fa-solid fa-puzzle-piece"></i></div>
          <h4>2-3 ‡∏Ç‡∏ß‡∏ö</h4>
          <p>‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏¥‡∏™</p>
        </div>
        <div class="roadmap-card" onclick="filterByAge('3-6y')">
          <div class="icon-box"><i class="fa-solid fa-school"></i></div>
          <h4>3-6 ‡∏Ç‡∏ß‡∏ö</h4>
          <p>‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•</p>
        </div>
      </div>

      <div class="section-title" style="justify-content:space-between">
        <span><i class="fa-solid fa-book-open"></i> ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span>
        <span style="font-size:12px; color:var(--text-muted)" id="resultCount"></span>
      </div>

      <div id="gridContainer" class="article-grid"></div>
      
      <div style="display:flex; justify-content:center; gap:15px; margin-top:25px; align-items:center;">
        <button id="prevBtn" class="btn-read" style="background:#fff; border:1px solid #eee;" disabled><i class="fa-solid fa-chevron-left"></i></button>
        <span id="pageInfo" style="font-size:13px; font-weight:600; color:var(--text-muted);">1 / 1</span>
        <button id="nextBtn" class="btn-read" style="background:#fff; border:1px solid #eee;"><i class="fa-solid fa-chevron-right"></i></button>
      </div>
    </section>
  </div>
</main>

<!-- Info Modal -->
<div id="modalBackdrop" class="modal-backdrop">
  <div class="modal-modern">
    <header class="modal-header">
      <h2 id="mTitle" class="modal-title" style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis; padding-right:10px;">-</h2>
      <button id="closeModal" class="btn-close"><i class="fa-solid fa-xmark"></i></button>
    </header>
    <div class="modal-content">
      <div id="mDialogContent"></div>
      <div id="mSources" style="margin-top:20px; font-size:12px; color:#999; border-top:1px solid #eee; padding-top:10px;"></div>
    </div>
  </div>
</div>

<!-- Edit Profile Modal -->
<div id="editProfileModal" class="modal-backdrop">
  <div class="modal-modern">
    <header class="modal-header">
      <h2 class="modal-title">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</h2>
      <button onclick="closeEditProfile()" class="btn-close"><i class="fa-solid fa-xmark"></i></button>
    </header>
    <div class="modal-content">
      <div class="form-group">
        <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
        <input type="text" id="editName" class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ö‡∏∏‡∏ç">
      </div>
      <div class="form-group">
        <label class="form-label">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏)</label>
        <input type="date" id="editDob" class="form-input">
      </div>
      <div class="form-group">
        <label class="form-label">‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</label>
        <input type="file" id="editAvatar" class="form-input" accept="image/*">
      </div>
      <button onclick="saveProfile()" class="btn-save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>
  </div>
</div>

<!-- Chatbot AI Interface Modal -->
<div id="chatModal" class="modal-backdrop">
  <div class="modal-modern" style="height: 90vh; max-height: 90vh; display:flex; flex-direction:column;">
    <header class="modal-header" style="background:#f8f9fa; border-bottom:1px solid #ddd;">
      <h2 class="modal-title" style="display:flex; align-items:center; gap:10px;"><i class="fa-solid fa-robot" style="color:var(--primary)"></i> ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ (AI)</h2>
      <button onclick="closeChat()" class="btn-close"><i class="fa-solid fa-xmark"></i></button>
    </header>
    
    <!-- Native Chat Interface -->
    <div class="chat-interface">
      <div class="chat-messages" id="chatHistory">
        <div class="msg bot">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏°‡πà ‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏´‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏∞? üòä</div>
      </div>
      <div id="typingIndicator" class="typing-indicator">AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå...</div>
      <div class="chat-input-area">
        <input type="text" id="chatInput" class="chat-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." onkeypress="if(event.key==='Enter') sendChat()">
        <button class="btn-send" onclick="sendChat()"><i class="fa-solid fa-paper-plane"></i></button>
      </div>
    </div>
    
  </div>
</div>

<button onclick="openChat()" class="fab-ai"><i class="fa-solid fa-message"></i></button>

<script>
// Mock Data
const ARTICLES = [
  { "id": "inf0_01", "t": "0‚Äì6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ô‡∏°‡πÅ‡∏°‡πà", "ar": "0-6m", "tg": "‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£", "c": "‡πÉ‡∏´‡πâ‡∏ô‡∏°‡πÅ‡∏°‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å (‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ). ‡∏≠‡∏∏‡πâ‡∏°‡∏Å‡∏∂‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏™‡∏°‡∏≠. ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≠‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏¥‡∏ô.", "s": "WHO" },
  { "id": "inf0_02", "t": "0‚Äì6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ‡∏ô‡∏≠‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Safe Sleep)", "ar": "0-6m", "tg": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", "c": "‡∏ô‡∏≠‡∏ô‡∏´‡∏á‡∏≤‡∏¢‡∏ö‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô‡πÅ‡∏Ç‡πá‡∏á. ‡πÑ‡∏°‡πà‡πÅ‡∏ä‡∏£‡πå‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡∏û‡πà‡∏≠‡πÅ‡∏°‡πà. ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏≠‡∏ô/‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡πÉ‡∏ô‡πÄ‡∏ï‡∏µ‡∏¢‡∏á.", "s": "CDC" },
  { "id": "inf0_03", "t": "0‚Äì6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: Tummy Time", "ar": "0-6m", "tg": "‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£", "c": "‡∏à‡∏±‡∏ö‡∏Ñ‡∏ß‡πà‡∏≥‡πÄ‡∏•‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡∏∑‡πà‡∏ô. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 1-2 ‡∏ô‡∏≤‡∏ó‡∏µ. ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏≠‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á.", "s": "Pathways" },
  { "id": "inf1_01", "t": "6‚Äì12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏°‡∏∑‡πâ‡∏≠‡πÅ‡∏£‡∏Å", "ar": "6-12m", "tg": "‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£", "c": "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≤‡∏ß‡∏ö‡∏î/‡∏ú‡∏±‡∏Å‡∏ï‡πâ‡∏° 1 ‡∏°‡∏∑‡πâ‡∏≠. ‡πÄ‡∏ó‡∏™‡∏ï‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ‡∏ó‡∏µ‡∏•‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏á. ‡∏ù‡∏∂‡∏Å‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡∏ß.", "s": "MOPH" },
  { "id": "inf1_03", "t": "6‚Äì12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≤‡∏ô", "ar": "6-12m", "tg": "‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£", "c": "‡∏à‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏≤‡∏ô. ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏õ‡∏•‡∏±‡πä‡∏Å‡πÑ‡∏ü‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å. ‡∏ù‡∏∂‡∏Å‡πÄ‡∏Å‡∏≤‡∏∞‡∏¢‡∏∑‡∏ô.", "s": "CDC" },
  { "id": "tod1_01", "t": "1‚Äì2 ‡∏õ‡∏µ: ‡∏ù‡∏∂‡∏Å‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢ (Potty)", "ar": "1-2y", "tg": "‡∏™‡∏∏‡∏Ç‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢", "c": "‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ö‡∏≠‡∏Å‡∏â‡∏µ‡πà. ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ô‡∏±‡πà‡∏á‡∏Å‡∏£‡∏∞‡πÇ‡∏ñ‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÜ. ‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏î‡∏î‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏∏.", "s": "AAP" },
  { "id": "tod1_02", "t": "1‚Äì2 ‡∏õ‡∏µ: ‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÄ‡∏î‡πá‡∏Å‡∏Ç‡∏µ‡πâ‡πÇ‡∏°‡πÇ‡∏´", "ar": "1-2y", "tg": "‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", "c": "‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à. ‡∏Å‡∏≠‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏á‡∏ö‡∏•‡∏á. ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô.", "s": "Positive P." },
  { "id": "pre_01", "t": "3‚Äì6 ‡∏õ‡∏µ: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "ar": "3-6y", "tg": "‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", "c": "‡∏ù‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏Å‡∏¥‡∏ô/‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß). ‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢. ‡∏™‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£.", "s": "Ed. Gov" }
];

document.addEventListener('DOMContentLoaded', () => {
  // --- Global Refs ---
  const grid = document.getElementById('gridContainer');
  const modalBackdrop = document.getElementById('modalBackdrop');
  const searchInput = document.getElementById('searchInput');
  const monthDisplay = document.getElementById('monthDisplay');
  const eventDisplay = document.getElementById('eventDisplay');
  
  // --- Profile Logic (Persist & Age Calc) ---
  const profileNameEl = document.getElementById('profileName');
  const profileAgeEl = document.getElementById('profileAge');
  const profileImgEl = document.getElementById('profileImg');

  function calculateAge(dobStr) {
    if(!dobStr) return "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î";
    const dob = new Date(dobStr);
    const now = new Date();
    const diffTime = Math.abs(now - dob);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
    let years = now.getFullYear() - dob.getFullYear();
    let months = now.getMonth() - dob.getMonth();
    let days = now.getDate() - dob.getDate();
    if (days < 0) { months--; days += 30; }
    if (months < 0) { years--; months += 12; }
    
    if(years > 0) return `${years} ‡∏Ç‡∏ß‡∏ö ${months} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
    return `${months} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${days} ‡∏ß‡∏±‡∏ô`;
  }

  function loadProfile() {
    const savedName = localStorage.getItem('ppro_name');
    const savedDob = localStorage.getItem('ppro_dob');
    const savedAvatar = localStorage.getItem('ppro_avatar');

    if(savedName) profileNameEl.innerText = savedName;
    if(savedDob) profileAgeEl.innerText = calculateAge(savedDob);
    if(savedAvatar) profileImgEl.src = savedAvatar;
  }

  loadProfile(); // Init load

  // --- Edit Profile Modal ---
  window.openEditProfile = () => {
    document.getElementById('editName').value = localStorage.getItem('ppro_name') || '';
    document.getElementById('editDob').value = localStorage.getItem('ppro_dob') || '';
    document.getElementById('editProfileModal').classList.add('show');
  };
  window.closeEditProfile = () => {
    document.getElementById('editProfileModal').classList.remove('show');
  };
  window.saveProfile = () => {
    const name = document.getElementById('editName').value;
    const dob = document.getElementById('editDob').value;
    const file = document.getElementById('editAvatar').files[0];

    if(name) localStorage.setItem('ppro_name', name);
    if(dob) localStorage.setItem('ppro_dob', dob);

    if(file) {
      const reader = new FileReader();
      reader.onloadend = () => {
        localStorage.setItem('ppro_avatar', reader.result);
        loadProfile();
        closeEditProfile();
      };
      reader.readAsDataURL(file);
    } else {
      loadProfile();
      closeEditProfile();
    }
  };

  // --- Calendar Init ---
  const date = new Date();
  const thMonth = ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."];
  monthDisplay.innerText = `${thMonth[date.getMonth()]} ${date.getFullYear() + 543}`;
  
  const calGrid = document.querySelector('.cal-grid');
  const daysInM = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
  const startDay = new Date(date.getFullYear(), date.getMonth(), 1).getDay();
  
  for(let i=0; i<startDay; i++) calGrid.appendChild(document.createElement('div'));
  
  for(let i=1; i<=daysInM; i++) {
    const el = document.createElement('div');
    el.className = 'cal-date';
    el.innerText = i;
    if(i === date.getDate()) el.classList.add('active');
    if([5,12,25].includes(i)) el.classList.add('has-event');
    
    el.onclick = () => {
      document.querySelectorAll('.cal-date').forEach(d=>d.classList.remove('active'));
      el.classList.add('active');
      if([5,12,25].includes(i)) {
        eventDisplay.style.display = 'block';
        eventDisplay.innerText = i===5 ? "üíâ ‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô" : i===12 ? "üéÇ ‡∏Ñ‡∏£‡∏ö 7 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" : "ü¶∑ ‡∏´‡∏≤‡∏´‡∏°‡∏≠‡∏ü‡∏±‡∏ô";
      } else { eventDisplay.style.display = 'none'; }
    };
    calGrid.appendChild(el);
  }

  // --- Grid & Logic ---
  let currentPage = 1;
  const PAGE_SIZE = 6;
  let currentFilter = 'all';
  let searchTerm = '';

  window.filterByAge = (age) => {
    currentFilter = age;
    currentPage = 1;
    document.querySelectorAll('.roadmap-card').forEach(c => c.classList.remove('active'));
    event.currentTarget.classList.add('active');
    render();
  };

  const render = () => {
    const filtered = ARTICLES.filter(x => {
      const matchAge = currentFilter === 'all' || x.ar === currentFilter;
      const matchSearch = !searchTerm || x.t.toLowerCase().includes(searchTerm) || x.tg.includes(searchTerm);
      return matchAge && matchSearch;
    });

    const total = filtered.length;
    const maxPage = Math.ceil(total / PAGE_SIZE) || 1;
    if(currentPage > maxPage) currentPage = maxPage;
    const start = (currentPage - 1) * PAGE_SIZE;
    const show = filtered.slice(start, start + PAGE_SIZE);

    document.getElementById('resultCount').innerText = `${total} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
    
    grid.innerHTML = show.map(item => `
      <div class="article-card" onclick="openModal('${item.id}')">
        <div class="article-body">
          <div class="article-tags"><span class="tag">${item.tg}</span></div>
          <h3 class="article-title">${item.t}</h3>
          <p class="article-desc">${item.c}</p>
          <div class="btn-read" style="align-self:flex-start; margin-top:auto;">‡∏≠‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠</div>
        </div>
      </div>
    `).join('');

    if(total===0) grid.innerHTML = `<div style="text-align:center; padding:30px; color:#ccc;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>`;
    document.getElementById('pageInfo').innerText = `${currentPage} / ${maxPage}`;
    document.getElementById('prevBtn').disabled = currentPage <= 1;
    document.getElementById('nextBtn').disabled = currentPage >= maxPage;
  };

  // --- Info Modal ---
  window.openModal = (id) => {
    const item = ARTICLES.find(x => x.id === id);
    if(!item) return;
    document.getElementById('mTitle').innerText = item.t;
    const lines = item.c.split('.').filter(x=>x.trim());
    let html = `<div class="chat-bubble">üëã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á <strong>${item.t}</strong> ‡∏Ñ‡πà‡∏∞</div>`;
    lines.forEach((l,i) => {
      html += `<div class="chat-bubble" style="animation:slideUp 0.3s backwards ${i*0.1}s">${l.trim()}.</div>`;
    });
    html += `<div class="chat-bubble highlight">üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏∞</div>`;
    document.getElementById('mDialogContent').innerHTML = html;
    document.getElementById('mSources').innerText = `‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: ${item.s}`;
    modalBackdrop.classList.add('show');
    document.body.style.overflow = 'hidden';
  };

  const closeModal = () => { modalBackdrop.classList.remove('show'); document.body.style.overflow = ''; };
  document.getElementById('closeModal').onclick = closeModal;
  modalBackdrop.onclick = (e) => { if(e.target===modalBackdrop) closeModal(); };
  
  // --- Chatbot Logic (API Connected) ---
  const chatHistory = document.getElementById('chatHistory');
  const chatInput = document.getElementById('chatInput');
  const typingIndicator = document.getElementById('typingIndicator');
  const API_URL = 'https://shy-fog-aa02.tontakankeawpang321.workers.dev/';

  window.openChat = () => { 
    document.getElementById('chatModal').classList.add('show'); 
    document.body.style.overflow = 'hidden'; 
    setTimeout(() => chatInput.focus(), 300);
  }
  
  window.closeChat = () => { 
    document.getElementById('chatModal').classList.remove('show'); 
    document.body.style.overflow = ''; 
  }

  window.sendChat = async () => {
    const text = chatInput.value.trim();
    if(!text) return;

    // 1. Add User Message
    addMessage(text, 'user');
    chatInput.value = '';
    
    // 2. Show Typing Indicator
    typingIndicator.style.display = 'block';
    
    try {
      // 3. Call API
      const response = await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: text }) // Standard schema, adapt if needed
      });

      if (!response.ok) throw new Error('Network response was not ok');

      const data = await response.json();
      
      // 4. Handle Response (Flexible for various API formats)
      const replyText = data.reply || data.response || data.answer || data.message || JSON.stringify(data);
      addMessage(replyText, 'bot');

    } catch (error) {
      console.error('Chat Error:', error);
      addMessage("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡πà‡∏∞ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏∞ üôè", 'bot');
    } finally {
      typingIndicator.style.display = 'none';
    }
  };

  function addMessage(text, sender) {
    const msgDiv = document.createElement('div');
    msgDiv.className = `msg ${sender}`;
    msgDiv.innerText = text;
    chatHistory.appendChild(msgDiv);
    chatHistory.scrollTop = chatHistory.scrollHeight; // Auto scroll to bottom
  }

  // --- Events ---
  searchInput.oninput = (e) => { searchTerm = e.target.value.toLowerCase(); currentPage=1; render(); };
  document.getElementById('prevBtn').onclick = () => { if(currentPage>1) currentPage--; render(); };
  document.getElementById('nextBtn').onclick = () => { currentPage++; render(); };

  render();
});
</script>
</body>
</html>
