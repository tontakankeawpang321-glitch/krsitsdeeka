<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏û‡∏à‡∏ô‡∏≤‡∏ô‡∏∏‡∏Å‡∏£‡∏°‡∏†‡∏≤‡∏©‡∏≤‡∏°‡∏∑‡∏≠‡πÑ‡∏ó‡∏¢ (TSL) Demo</title>
    <meta name="theme-color" content="#4f46e5">
    <meta name="description" content="‡∏û‡∏à‡∏ô‡∏≤‡∏ô‡∏∏‡∏Å‡∏£‡∏°‡∏†‡∏≤‡∏©‡∏≤‡∏°‡∏∑‡∏≠‡πÑ‡∏ó‡∏¢ ‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Base Setup */
        body { 
            font-family: 'Noto Sans Thai', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
        }

        /* Hide Scrollbar */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        html { scroll-behavior: smooth; }

        /* Skeleton Loading */
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        .skeleton {
            background: linear-gradient(to right, #f1f5f9 4%, #e2e8f0 25%, #f1f5f9 36%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite linear;
        }

        /* Bottom Sheet Transition */
        .bottom-sheet {
            transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            transform: translateY(100%);
            will-change: transform;
        }
        .bottom-sheet.active { transform: translateY(0); }

        /* Chat Animations */
        @keyframes messagePop {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .msg-anim { animation: messagePop 0.2s ease-out forwards; }

        /* Mock Thinking Bar */
        .thinking-bar {
            height: 4px;
            width: 100%;
            background: linear-gradient(90deg, #4f46e5, #818cf8, #c7d2fe, #4f46e5);
            background-size: 200% 100%;
            animation: thinking 1.5s linear infinite;
            border-radius: 4px;
        }
        @keyframes thinking { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 pb-24 selection:bg-indigo-100 selection:text-indigo-700">

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-40 bg-indigo-600 text-white shadow-lg transition-all duration-300" id="mainHeader">
        <div class="max-w-md mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="p-2 bg-white/20 rounded-xl backdrop-blur-sm">
                    <i data-lucide="hand" class="w-6 h-6 text-yellow-300"></i>
                </div>
                <div>
                    <h1 class="text-lg font-bold leading-tight">TSL Dictionary</h1>
                    <p class="text-[10px] text-indigo-200 font-medium tracking-wide">‡∏â‡∏ö‡∏±‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á (Offline Mode)</p>
                </div>
            </div>
            <button class="p-2 text-indigo-100 hover:text-white active:scale-95 transition">
                <i data-lucide="info" class="w-6 h-6"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-md mx-auto px-4 pt-20">
        
        <!-- Search & Categories (Sticky) -->
        <div class="sticky top-[60px] z-30 pt-4 pb-2 -mx-4 px-4 bg-slate-50/95 backdrop-blur-sm border-b border-slate-200 transition-shadow" id="searchBarContainer">
            <div class="relative">
                <div class="absolute left-4 top-3.5 text-slate-400">
                    <i data-lucide="search" class="w-5 h-5"></i>
                </div>
                <input 
                    id="searchInput" 
                    type="search" 
                    enterkeyhint="search"
                    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, ‡∏£‡∏±‡∏Å, ‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞)..." 
                    class="w-full pl-11 pr-4 py-3 rounded-2xl bg-white border border-slate-200 shadow-sm text-slate-700 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all placeholder:text-slate-400"
                >
            </div>

            <div class="flex items-center gap-2 overflow-x-auto scrollbar-hide mt-3 pb-2 select-none" id="categoryContainer">
                <!-- Categories injected by JS -->
            </div>
        </div>

        <!-- Content Grid -->
        <div id="gridContainer" class="grid grid-cols-2 gap-3 mt-4 min-h-[50vh]"></div>

        <!-- Loading / Empty States -->
        <div id="loadingState" class="hidden grid grid-cols-2 gap-3 mt-4">
            <div class="aspect-[4/3] rounded-2xl skeleton"></div>
            <div class="aspect-[4/3] rounded-2xl skeleton"></div>
            <div class="aspect-[4/3] rounded-2xl skeleton"></div>
            <div class="aspect-[4/3] rounded-2xl skeleton"></div>
        </div>

        <div id="emptyState" class="hidden py-16 text-center text-slate-400">
            <div class="bg-slate-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="search-x" class="w-10 h-10 opacity-50"></i>
            </div>
            <p class="text-sm font-medium">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
        </div>

    </main>

    <!-- FAB (Chat Button) -->
    <button id="fabChat" class="fixed bottom-6 right-5 w-14 h-14 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full shadow-lg shadow-indigo-600/30 flex items-center justify-center z-40 transition-transform active:scale-90">
        <i data-lucide="message-circle" class="w-7 h-7"></i>
    </button>

    <!-- Bottom Sheet (Details) -->
    <div id="detailBackdrop" class="fixed inset-0 bg-black/60 z-50 opacity-0 pointer-events-none transition-opacity duration-300 backdrop-blur-sm" onclick="closeDetailSheet()"></div>
    
    <div id="detailSheet" class="fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-[32px] bottom-sheet max-h-[90vh] flex flex-col shadow-2xl overflow-hidden max-w-md mx-auto">
        <div class="w-full flex justify-center pt-3 pb-1 flex-shrink-0" onclick="closeDetailSheet()">
            <div class="w-12 h-1.5 bg-slate-300 rounded-full"></div>
        </div>

        <div class="overflow-y-auto flex-1 p-0 pb-8 scrollbar-hide">
            <div class="relative w-full aspect-video bg-slate-100">
                <img id="sheetImage" class="w-full h-full object-cover" src="" alt="Sign Language Image" loading="lazy">
                <div id="sheetNoImage" class="absolute inset-0 flex flex-col items-center justify-center text-slate-400 hidden">
                    <i data-lucide="image-off" class="w-8 h-8 mb-2 opacity-50"></i>
                    <span class="text-xs">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>
                </div>
                <button onclick="closeDetailSheet()" class="absolute top-4 right-4 bg-black/30 text-white p-2 rounded-full backdrop-blur-md active:scale-90 transition">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <div class="px-6 py-5">
                <div class="flex items-start gap-4 mb-4">
                    <div id="sheetIcon" class="w-14 h-14 rounded-2xl flex-shrink-0 flex items-center justify-center text-2xl font-bold text-white bg-indigo-500 shadow-lg shadow-indigo-200">‡∏Å</div>
                    <div>
                        <span id="sheetCategory" class="text-[10px] font-bold uppercase tracking-wider text-indigo-600 bg-indigo-50 px-2 py-1 rounded-md mb-1 inline-block">‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span>
                        <h2 id="sheetTitle" class="text-3xl font-bold text-slate-800 leading-none">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ</h2>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="p-4 bg-slate-50 rounded-2xl border border-slate-100 text-slate-600 text-sm leading-relaxed">
                        <h3 class="font-semibold text-slate-800 mb-1 text-xs uppercase opacity-70">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏ó‡πà‡∏≤</h3>
                        <p id="sheetDesc">...</p>
                    </div>

                    <div id="sheetTipBox" class="p-4 bg-amber-50 rounded-2xl border border-amber-100 flex gap-3 hidden">
                        <i data-lucide="lightbulb" class="w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"></i>
                        <div>
                            <h3 class="font-bold text-amber-700 text-xs mb-1">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏à‡∏≥</h3>
                            <p id="sheetTip" class="text-sm text-amber-800">...</p>
                        </div>
                    </div>

                    <a id="sheetYoutube" href="#" target="_blank" class="flex items-center justify-center gap-2 w-full py-3.5 bg-red-50 text-red-600 font-bold rounded-xl active:bg-red-100 transition border border-red-100">
                        <i data-lucide="youtube" class="w-5 h-5"></i>
                        ‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏™‡∏≤‡∏ò‡∏¥‡∏ï
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Modal (Simulated) -->
    <div id="chatModal" class="fixed inset-0 z-50 bg-white transform translate-y-full transition-transform duration-300 flex flex-col">
        <div class="bg-indigo-600 text-white px-4 py-3 flex items-center justify-between shadow-md flex-shrink-0">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
                    <i data-lucide="bot" class="w-5 h-5"></i>
                </div>
                <div>
                    <h2 class="font-bold text-base">‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó (‡∏à‡∏≥‡∏•‡∏≠‡∏á)</h2>
                    <div class="flex items-center gap-1.5 opacity-80">
                        <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                        <span class="text-[10px]">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                    </div>
                </div>
            </div>
            <button onclick="toggleChat(false)" class="p-2 hover:bg-white/10 rounded-full transition">
                <i data-lucide="chevron-down" class="w-6 h-6"></i>
            </button>
        </div>

        <div id="chatHistory" class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 scrollbar-hide">
            <div class="flex gap-3 msg-anim">
                <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0 text-lg">ü§ñ</div>
                <div class="bg-white border border-slate-200 p-3 rounded-2xl rounded-tl-none shadow-sm max-w-[85%] text-sm text-slate-700">
                    ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á (Demo) ‡∏ú‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏õ‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö
                </div>
            </div>
        </div>

        <div class="p-3 bg-white border-t border-slate-100 flex-shrink-0 pb-safe">
            <div class="relative flex items-end gap-2">
                <button id="chatResetBtn" class="p-3 text-slate-400 hover:text-indigo-600 bg-slate-100 rounded-xl transition" title="‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà">
                    <i data-lucide="rotate-ccw" class="w-5 h-5"></i>
                </button>
                <textarea id="chatInput" rows="1" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." class="flex-1 bg-slate-100 text-slate-800 text-sm rounded-xl px-4 py-3 focus:ring-2 focus:ring-indigo-500 outline-none resize-none max-h-24 overflow-y-auto"></textarea>
                <button id="chatSendBtn" class="p-3 bg-indigo-600 text-white rounded-xl shadow-md shadow-indigo-200 active:scale-95 transition disabled:opacity-50">
                    <i data-lucide="send" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ================= CONFIGURATION & DATA ================= //
        // * ‡∏ï‡∏±‡∏î API URL ‡πÅ‡∏•‡∏∞ Key ‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î *
        
        // Mock Data: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå JSON ‡∏´‡∏£‡∏∑‡∏≠ API
        const MOCK_DATA = [
            { id: 1, word: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ", category: "daily", description: "‡∏¢‡∏Å‡∏°‡∏∑‡∏≠‡∏û‡∏ô‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏Å ‡∏Å‡πâ‡∏°‡∏®‡∏µ‡∏£‡∏©‡∏∞‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", imageUrl: "https://images.unsplash.com/photo-1622547748225-3fc4abd2cca0?q=80&w=600&auto=format&fit=crop", tip: "‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏´‡∏ç‡∏¥‡∏á" },
            { id: 2, word: "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì", category: "daily", description: "‡∏°‡∏∑‡∏≠‡∏Ç‡∏ß‡∏≤‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¢‡∏±‡∏Å‡∏´‡∏ô‡πâ‡∏≤", imageUrl: "https://images.unsplash.com/photo-1596464716127-f9a862557965?q=80&w=600&auto=format&fit=crop" },
            { id: 3, word: "‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©", category: "daily", description: "‡∏Å‡∏≥‡∏°‡∏∑‡∏≠‡∏Ç‡∏ß‡∏≤ ‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢", imageUrl: "", tip: "‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏≥‡∏ô‡∏∂‡∏Å‡∏ú‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢" },
            { id: 4, word: "‡∏û‡πà‡∏≠", category: "family", description: "‡∏ô‡∏¥‡πâ‡∏ß‡πÇ‡∏õ‡πâ‡∏á‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≤‡∏¢‡∏à‡∏°‡∏π‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏≤‡∏Å", imageUrl: "https://images.unsplash.com/photo-1511895426328-dc8714191300?q=80&w=600&auto=format&fit=crop" },
            { id: 5, word: "‡πÅ‡∏°‡πà", category: "family", description: "‡∏ô‡∏¥‡πâ‡∏ß‡πÇ‡∏õ‡πâ‡∏á‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡∏°‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤", imageUrl: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=600&auto=format&fit=crop" },
            { id: 6, word: "‡∏£‡∏±‡∏Å", category: "emotion", description: "‡∏Å‡∏≥‡∏°‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡πÑ‡∏Ç‡∏ß‡πâ‡∏Å‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å", imageUrl: "https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=600&auto=format&fit=crop" },
            { id: 7, word: "‡∏Å.‡πÑ‡∏Å‡πà", category: "consonant", description: "‡∏Å‡∏≥‡∏°‡∏∑‡∏≠ ‡∏ä‡∏π‡∏ô‡∏¥‡πâ‡∏ß‡∏ä‡∏µ‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏á‡∏≠‡∏ô‡∏¥‡πâ‡∏ß‡∏ä‡∏µ‡πâ‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏´‡∏±‡∏ß‡πÑ‡∏Å‡πà", imageUrl: "" },
            { id: 8, word: "‡∏´‡∏¥‡∏ß", category: "daily_life", description: "‡πÉ‡∏ä‡πâ‡∏°‡∏∑‡∏≠‡∏•‡∏π‡∏ö‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ó‡πâ‡∏≠‡∏á ‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏∞‡∏î‡∏∑‡∏≠", imageUrl: "" },
            { id: 9, word: "‡∏ô‡πâ‡∏≥", category: "food", description: "‡∏ä‡∏π‡∏ô‡∏¥‡πâ‡∏ß‡πÇ‡∏õ‡πâ‡∏á ‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏≤‡∏Å‡∏™‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á", imageUrl: "https://images.unsplash.com/photo-1548839140-29a749e1cf4d?q=80&w=600&auto=format&fit=crop" },
            { id: 10, word: "‡∏ö‡πâ‡∏≤‡∏ô", category: "place", description: "‡∏õ‡∏£‡∏∞‡∏Å‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏ô‡∏¥‡πâ‡∏ß‡∏°‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏à‡∏±‡πà‡∏ß‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤", imageUrl: "https://images.unsplash.com/photo-1518780664697-55e3ad937233?q=80&w=600&auto=format&fit=crop" },
        ];

        let allSigns = [];
        let activeCategory = 'all';

        const categories = [
            { id: "all", label: "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", icon: "book-open", color: "bg-indigo-600" },
            { id: "consonant", label: "‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞", icon: "type", color: "bg-orange-500" },
            { id: "daily", label: "‡∏Ñ‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", icon: "star", color: "bg-yellow-500" },
            { id: "family", label: "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß", icon: "users", color: "bg-pink-500" },
            { id: "emotion", label: "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå", icon: "smile", color: "bg-purple-500" },
            { id: "food", label: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£", icon: "coffee", color: "bg-emerald-500" },
            { id: "place", label: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà", icon: "map-pin", color: "bg-blue-500" },
        ];

        // ================= APP INITIALIZATION ================= //
        document.addEventListener('DOMContentLoaded', async () => {
            renderCategories();
            lucide.createIcons();
            
            document.getElementById('gridContainer').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');

            try {
                // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå signs500.json (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                const res = await fetch('signs500.json');
                if (!res.ok) throw new Error("File not found");
                allSigns = await res.json();
            } catch (error) {
                // ‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Mock Data ‡πÅ‡∏ó‡∏ô
                console.log("Using Mock Data");
                allSigns = MOCK_DATA;
            } finally {
                // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô Loading (‡πÄ‡∏û‡∏∑‡πà‡∏≠ UX)
                setTimeout(() => {
                    document.getElementById('loadingState').classList.add('hidden');
                    document.getElementById('gridContainer').classList.remove('hidden');
                    renderGrid(allSigns);
                }, 800);
            }

            setupSearch();
            setupChat();
        });

        // ================= LOGIC: RENDER & SEARCH ================= //
        function renderCategories() {
            const container = document.getElementById('categoryContainer');
            container.innerHTML = categories.map(c => `
                <button onclick="filterCategory('${c.id}')" 
                    class="whitespace-nowrap px-4 py-2 rounded-full border text-sm font-medium transition-all duration-200 flex items-center gap-2
                    ${activeCategory === c.id 
                        ? 'bg-slate-800 text-white border-slate-800 shadow-md transform scale-105' 
                        : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-100'}">
                    <i data-lucide="${c.icon}" class="w-3.5 h-3.5"></i>
                    ${c.label}
                </button>
            `).join('');
            lucide.createIcons();
        }

        function filterCategory(id) {
            activeCategory = id;
            renderCategories();
            filterData(document.getElementById('searchInput').value);
        }

        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            let timeout;
            searchInput.addEventListener('input', (e) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => filterData(e.target.value), 300);
            });
            searchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') searchInput.blur();
            });
        }

        function filterData(query) {
            const term = query.toLowerCase().trim();
            const filtered = allSigns.filter(item => {
                const matchCat = activeCategory === 'all' || item.category === activeCategory;
                const matchSearch = item.word.includes(term) || (item.description && item.description.includes(term));
                return matchCat && matchSearch;
            });
            renderGrid(filtered);
        }

        function renderGrid(data) {
            const grid = document.getElementById('gridContainer');
            const empty = document.getElementById('emptyState');

            if (data.length === 0) {
                grid.innerHTML = '';
                empty.classList.remove('hidden');
                return;
            }

            empty.classList.add('hidden');
            grid.innerHTML = data.map(item => {
                const catObj = categories.find(c => c.id === item.category) || categories[0];
                return `
                <div onclick="openDetailSheet(${item.id})" class="group bg-white rounded-2xl p-3 border border-slate-100 shadow-sm hover:shadow-md transition active:scale-95 cursor-pointer flex flex-col h-full relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full ${catObj.color}"></div>
                    
                    <div class="w-full aspect-square rounded-xl bg-slate-100 mb-3 overflow-hidden relative">
                         ${item.imageUrl 
                            ? `<img src="${item.imageUrl}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">
                               <div class="hidden absolute inset-0 items-center justify-center text-slate-300 bg-slate-50"><i data-lucide="image-off"></i></div>`
                            : `<div class="w-full h-full flex items-center justify-center text-slate-300 font-bold text-4xl select-none bg-slate-50">${item.word.charAt(0)}</div>`
                         }
                    </div>
                    
                    <div class="flex-1">
                        <span class="text-[10px] text-slate-400 font-medium bg-slate-50 px-1.5 py-0.5 rounded uppercase tracking-wide border border-slate-100 mb-1 inline-block">
                            ${catObj.label}
                        </span>
                        <h3 class="font-bold text-slate-800 text-lg leading-tight line-clamp-1">${item.word}</h3>
                    </div>
                </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        // ================= UI: DETAIL SHEET ================= //
        function openDetailSheet(id) {
            const item = allSigns.find(i => i.id === id);
            if (!item) return;

            document.getElementById('sheetTitle').textContent = item.word;
            document.getElementById('sheetDesc').textContent = item.description || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢";
            
            const catObj = categories.find(c => c.id === item.category) || categories[0];
            document.getElementById('sheetCategory').textContent = catObj.label;
            
            const iconEl = document.getElementById('sheetIcon');
            iconEl.textContent = item.word.charAt(0);
            iconEl.className = `w-14 h-14 rounded-2xl flex-shrink-0 flex items-center justify-center text-2xl font-bold text-white shadow-lg ${catObj.color}`;

            const imgEl = document.getElementById('sheetImage');
            const noImgEl = document.getElementById('sheetNoImage');
            if (item.imageUrl) {
                imgEl.src = item.imageUrl;
                imgEl.classList.remove('hidden');
                noImgEl.classList.add('hidden');
                imgEl.onerror = () => { imgEl.classList.add('hidden'); noImgEl.classList.remove('hidden'); };
            } else {
                imgEl.classList.add('hidden');
                noImgEl.classList.remove('hidden');
            }

            const tipBox = document.getElementById('sheetTipBox');
            if (item.tip) {
                document.getElementById('sheetTip').textContent = item.tip;
                tipBox.classList.remove('hidden');
            } else {
                tipBox.classList.add('hidden');
            }

            const ytBtn = document.getElementById('sheetYoutube');
            if (item.youtubeUrl) {
                ytBtn.href = item.youtubeUrl;
                ytBtn.innerHTML = `<i data-lucide="youtube" class="w-5 h-5"></i> ‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏™‡∏≤‡∏ò‡∏¥‡∏ï`;
            } else {
                ytBtn.href = `https://www.youtube.com/results?search_query=‡∏†‡∏≤‡∏©‡∏≤‡∏°‡∏∑‡∏≠‡πÑ‡∏ó‡∏¢+${item.word}`;
                ytBtn.innerHTML = `<i data-lucide="search" class="w-5 h-5"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô YouTube`;
            }
            lucide.createIcons();

            document.body.style.overflow = 'hidden';
            document.getElementById('detailBackdrop').classList.remove('pointer-events-none', 'opacity-0');
            document.getElementById('detailSheet').classList.add('active');
        }

        function closeDetailSheet() {
            document.body.style.overflow = '';
            document.getElementById('detailBackdrop').classList.add('pointer-events-none', 'opacity-0');
            document.getElementById('detailSheet').classList.remove('active');
        }

        // ================= UI: SIMULATED CHAT ================= //
        const chatModal = document.getElementById('chatModal');
        const fabChat = document.getElementById('fabChat');
        
        fabChat.addEventListener('click', () => toggleChat(true));

        function toggleChat(show) {
            if (show) {
                chatModal.classList.remove('translate-y-full');
                document.getElementById('chatInput').focus();
            } else {
                chatModal.classList.add('translate-y-full');
                document.getElementById('searchInput').blur();
            }
        }

        function setupChat() {
            const input = document.getElementById('chatInput');
            const sendBtn = document.getElementById('chatSendBtn');
            const resetBtn = document.getElementById('chatResetBtn');
            const history = document.getElementById('chatHistory');

            // ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á (Simulated Responses)
            const mockResponses = [
                "‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Demo ‡∏Ñ‡∏£‡∏±‡∏ö ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏≠‡∏ö‡πÇ‡∏ï‡πâ‡πÅ‡∏ö‡∏ö AI ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö",
                "‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö",
                "‡∏†‡∏≤‡∏©‡∏≤‡∏°‡∏∑‡∏≠‡πÑ‡∏ó‡∏¢‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö",
                "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö"
            ];

            function addMessage(text, isUser) {
                const div = document.createElement('div');
                div.className = `flex gap-3 msg-anim ${isUser ? 'flex-row-reverse' : ''}`;
                const avatar = isUser ? 'üë§' : 'ü§ñ';
                const avatarClass = isUser ? 'bg-indigo-600 text-white' : 'bg-indigo-100 text-indigo-700';
                const bubbleClass = isUser ? 'bg-indigo-600 text-white rounded-tr-none' : 'bg-white border border-slate-200 text-slate-700 rounded-tl-none';

                div.innerHTML = `
                    <div class="w-8 h-8 rounded-full ${avatarClass} flex items-center justify-center flex-shrink-0 text-sm shadow-sm">${avatar}</div>
                    <div class="${bubbleClass} p-3 rounded-2xl shadow-sm max-w-[85%] text-sm leading-relaxed">
                        ${text.replace(/\n/g, '<br>')}
                    </div>
                `;
                history.appendChild(div);
                history.scrollTo(0, history.scrollHeight);
            }

            function addLoading() {
                const div = document.createElement('div');
                div.id = 'aiLoading';
                div.className = 'flex gap-3 msg-anim';
                div.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0">ü§ñ</div>
                    <div class="bg-white border border-slate-200 p-3 rounded-2xl rounded-tl-none shadow-sm w-24">
                        <div class="thinking-bar"></div>
                    </div>
                `;
                history.appendChild(div);
                history.scrollTo(0, history.scrollHeight);
            }

            function removeLoading() {
                const el = document.getElementById('aiLoading');
                if (el) el.remove();
            }

            function sendMessage() {
                const text = input.value.trim();
                if (!text) return;

                input.value = '';
                input.style.height = 'auto';
                addMessage(text, true);
                addLoading();
                sendBtn.disabled = true;

                // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (Simulation)
                setTimeout(() => {
                    removeLoading();
                    const randomReply = mockResponses[Math.floor(Math.random() * mockResponses.length)];
                    addMessage(randomReply, false);
                    sendBtn.disabled = false;
                }, 1200);
            }

            sendBtn.addEventListener('click', sendMessage);
            resetBtn.addEventListener('click', () => {
                history.innerHTML = '';
                addMessage('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö', false);
            });

            input.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        }
    </script>
</body>
</html>
