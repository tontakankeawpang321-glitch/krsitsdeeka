<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Crow Studio - Classic Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&family=Anuphan:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --ink: #1e293b;
            --paper: #f4f1ea;
            --border: #d1cfc7;
        }
        body {
            font-family: 'Lora', 'Anuphan', serif;
            background-color: var(--paper);
            color: var(--ink);
            background-image: url('https://www.transparenttextures.com/patterns/natural-paper.png');
            overflow-x: hidden;
        }
        /* Classic Header Line */
        .header-line {
            height: 1px;
            background: linear-gradient(to right, transparent, var(--ink), transparent);
            margin: 1.5rem 0;
            opacity: 0.3;
        }
        /* Stamp Button - Classic Style */
        .stamp-btn {
            position: relative;
            background: transparent;
            border-radius: 50%;
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--ink);
            overflow: hidden; /* ‡∏ï‡∏±‡∏î‡∏£‡∏π‡∏õ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏° */
            transition: all 0.2s ease;
            cursor: pointer;
            box-shadow: 0 0 0 4px transparent;
        }
        .stamp-btn::after {
            content: '';
            position: absolute;
            inset: 0;
            border: 4px solid var(--paper); /* ‡∏Ç‡∏≠‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏£‡∏≤‡∏õ‡∏±‡πä‡∏°‡∏°‡∏µ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            border-radius: 50%;
            z-index: 10;
            pointer-events: none;
        }
        /* Pressing Effect Like a Real Stamp */
        .stamp-btn:active {
            transform: scale(0.92);
            filter: contrast(1.4) brightness(0.8);
        }
        .stamp-btn:hover {
            border-width: 3px;
            box-shadow: 0 8px 16px rgba(30, 41, 59, 0.15);
        }
        .stamp-btn img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏†‡∏≤‡∏û‡πÄ‡∏ï‡πá‡∏°‡∏ß‡∏á‡∏Å‡∏•‡∏° */
            filter: sepia(0.2) contrast(1.1) grayscale(0.2);
            mix-blend-mode: multiply;
            transition: all 0.3s ease;
        }
        .stamp-btn:hover img {
            filter: sepia(0) contrast(1.2) grayscale(0);
            transform: scale(1.1);
        }
        /* Chatbot Classic UI */
        .glass-panel {
            background: rgba(244, 241, 234, 0.98);
            border: 1px solid var(--ink);
            box-shadow: 8px 8px 0px rgba(30, 41, 59, 0.1);
        }
        .chat-input {
            border: 1px solid var(--ink);
            background: transparent;
        }
        /* Responsive Grid Fix */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
        }
        @media (min-width: 640px) {
            .grid-container { grid-template-columns: repeat(3, 1fr); }
        }
        @media (min-width: 1024px) {
            .grid-container { grid-template-columns: repeat(4, 1fr); }
        }
        /* Fade-in for classic feel */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-entry { animation: fadeIn 0.8s ease forwards; }
    </style>
</head>
<body class="min-h-screen px-6 py-12 md:py-20">

    <div class="max-w-4xl mx-auto">
        <!-- Brand Header -->
        <header class="text-center mb-16 fade-entry">
            <h2 class="text-xs uppercase tracking-[0.5em] mb-4 opacity-60 font-bold text-slate-500">Est. 2025</h2>
            <h1 class="text-5xl md:text-7xl font-bold mb-2 tracking-tight italic">Crow Studio</h1>
            <div class="header-line"></div>
            <p class="text-sm md:text-lg italic opacity-70">
                A Library of Endless Languages
            </p>
        </header>

        <!-- Classic Grid Area -->
        <section class="grid-container mb-24">
            <script>
                const languages = [
                    { id: 'us', name: 'USA', url: 'https://sites.google.com/view/pasa30one/%E0%B8%AD%E0%B9%80%E0%B8%A1%E0%B8%A3%E0%B8%81%E0%B8%B2-us' },
                    { id: 'gb', name: 'Britain', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%A4%E0%B8%A9-uk' },
                    { id: 'cn', name: 'China', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B8%88%E0%B8%99-ch' },
                    { id: 'mm', name: 'Myanmar', url: 'https://sites.google.com/view/pasa30one/%E0%B8%9E%E0%B8%A1%E0%B8%B2-ma' },
                    { id: 'jp', name: 'Japan', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B8%8D%E0%B8%9B%E0%B8%99-jp' },
                    { id: 'kr', name: 'Korea', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B9%80%E0%B8%A1%E0%B8%A3%E0%B8%81%E0%B8%B2-us' },
                    { id: 'kh', name: 'Cambodia', url: 'https://sites.google.com/view/pasa30one/%E0%B8%81%E0%B8%A1%E0%B8%9E%E0%B8%8A%E0%B8%B2-kom' },
                    { id: 'vn', name: 'Vietnam', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B9%80%E0%B8%A7%E0%B8%A2%E0%B8%94%E0%B8%99%E0%B8%B2%E0%B8%A1-vein' },
                    { id: 'ru', name: 'Russia', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B8%A3%E0%B8%AA%E0%B9%80%E0%B8%8B%E0%B8%A2-rus' },
                    { id: 'de', name: 'Germany', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B9%80%E0%B8%A2%E0%B8%AD%E0%B8%A3%E0%B8%A1%E0%B8%99-ge' },
                    { id: 'es', name: 'Spain', url: 'https://sites.google.com/view/pasa30one/%E0%B8%A0%E0%B8%B2%E0%B8%A9%E0%B8%B2%E0%B8%AA%E0%B9%80%E0%B8%9B%E0%B8%99-sp' }
                ];
                
                document.write(languages.map((lang) => `
                    <div class="flex flex-col items-center space-y-4 fade-entry">
                        <a href="${lang.url}" target="_blank" class="stamp-btn w-full max-w-[120px]">
                            <img src="https://flagcdn.com/w160/${lang.id}.png" alt="${lang.name}">
                        </a>
                        <span class="text-[10px] font-bold tracking-[0.2em] uppercase opacity-50">${lang.name}</span>
                    </div>
                `).join(''));
            </script>
        </section>

        <!-- Footer -->
        <footer class="text-center py-12 opacity-40 border-t border-slate-300">
            <p class="text-[10px] uppercase tracking-[0.3em]">
                &copy; 2025 Crow Studio &bull; Archive Reference &bull; FreeToLearn
            </p>
        </footer>
    </div>

    <!-- Classic Chat Interface -->
    <div id="chat-widget" class="fixed bottom-8 right-8 z-50 flex flex-col items-end">
        <div id="chat-box" class="hidden w-[calc(100vw-4rem)] sm:w-[320px] h-[450px] mb-6 rounded-lg overflow-hidden glass-panel flex flex-col shadow-2xl">
            <div class="p-4 border-b border-slate-300 flex items-center justify-between bg-slate-100/50">
                <span class="text-xs font-bold tracking-tighter uppercase italic">Librarian Assistant</span>
                <button onclick="toggleChat()" class="text-lg leading-none hover:opacity-50">√ó</button>
            </div>
            
            <div id="chat-window" class="flex-1 p-6 overflow-y-auto space-y-4 text-sm italic leading-relaxed bg-white/30">
                <div class="text-slate-500">
                    "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö?"
                </div>
            </div>

            <div class="p-4 border-t border-slate-200">
                <div class="flex items-center space-x-2">
                    <input type="text" id="user-input" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." class="chat-input flex-1 outline-none text-xs px-3 py-2 rounded border-slate-300">
                    <button id="send-btn" class="font-bold text-xs hover:underline uppercase text-slate-800">‡∏™‡πà‡∏á</button>
                </div>
            </div>
        </div>

        <!-- Chat Trigger Button (Stamp Style) -->
        <button onclick="toggleChat()" class="bg-slate-800 text-white w-14 h-14 rounded-full shadow-2xl hover:bg-slate-700 active:scale-90 transition-all flex items-center justify-center border-4 border-white/20">
            <svg id="fab-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
        </button>
    </div>

    <script>
        const chatBox = document.getElementById('chat-box');
        const chatWindow = document.getElementById('chat-window');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');

        const WORKER_URL = "https://spring-bush-acec.tontakankeawpang321.workers.dev";

        let isOpen = false;

        function toggleChat() {
            isOpen = !isOpen;
            chatBox.classList.toggle('hidden', !isOpen);
            if (isOpen) userInput.focus();
        }

        async function fetchAIResponse(message, retries = 5, delay = 1000) {
            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });

                if (!response.ok) {
                    if (response.status === 429 && retries > 0) {
                        await new Promise(r => setTimeout(r, delay));
                        return fetchAIResponse(message, retries - 1, delay * 2);
                    }
                    throw new Error('Worker error');
                }

                const data = await response.json();
                return data.text || "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö Librarian ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£";
            } catch (error) {
                if (retries > 0) {
                    await new Promise(r => setTimeout(r, delay));
                    return fetchAIResponse(message, retries - 1, delay * 2);
                }
                return "‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏´‡∏≠‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß... üì°";
            }
        }

        function appendMessage(text, role) {
            const div = document.createElement('div');
            div.className = `flex flex-col ${role === 'user' ? 'items-end' : 'items-start'} animate-fade-in`;
            const bubble = document.createElement('div');
            bubble.className = role === 'user' 
                ? 'px-4 py-2 bg-slate-200 rounded-lg text-slate-800 text-xs shadow-sm' 
                : 'px-0 py-2 text-slate-600 text-sm italic leading-relaxed';
            bubble.textContent = (role === 'user' ? '' : '"') + text + (role === 'user' ? '' : '"');
            div.appendChild(bubble);
            chatWindow.appendChild(div);
            chatWindow.scrollTo({ top: chatWindow.scrollHeight, behavior: 'smooth' });
        }

        async function handleSend() {
            const text = userInput.value.trim();
            if (!text) return;

            appendMessage(text, 'user');
            userInput.value = '';
            
            const loading = document.createElement('div');
            loading.className = 'text-[10px] opacity-40 italic';
            loading.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏...';
            chatWindow.appendChild(loading);
            chatWindow.scrollTop = chatWindow.scrollHeight;

            const aiResponse = await fetchAIResponse(text);
            loading.remove();
            appendMessage(aiResponse, 'bot');
        }

        sendBtn.addEventListener('click', handleSend);
        userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSend(); });
    </script>
</body>
</html>
